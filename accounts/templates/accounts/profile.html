 {% extends 'base.html' %} {% load static %} {% block head_title %}Banking System{% endblock %} {% block content %} {% if form.non_field_errors %} {% for error in form.non_field_errors %}
<div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mt-2" role="alert">
    <p class="font-bold">Error!</p>
    <p class="block sm:inline">{{ error }}</p>
</div>
{% endfor %} {% endif %} {% if form.non_field_errors %} {% for error in form.non_field_errors %}
<div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mt-2" role="alert">
    <p class="font-bold">Error!</p>
    <p class="block sm:inline">{{ error }}</p>
</div>
{% endfor %} {% endif %}
{% comment %} <div class="bg-white px-3 py-4 rounded-xl my-6">

    <h4 class="font-bold text-3xl text-left pb-5">Account NO: {{request.user.account.account_no}}</h4>
    <h1 class="font-bold text-3xl text-center pb-5">Update Profile Information</h1>
    <div class="w-full mt-10">
        <form method="post" class="bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4">
            {% csrf_token %} {% for hidden_field in form.hidden_fields %} {{ hidden_field.errors }} {{ hidden_field }} {% endfor %}
            <div class="flex flex-wrap -mx-3 mb-6">
                <div class="w-full md:w-1/2 px-3 mb-6 md:mb-0">
                    <label class="block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2" for="{{ form.first_name.id_for_label }}">
                        {{ form.first_name.label }}
                    </label> {{ form.first_name }} {% if form.first_name.errors %} {% for error in form.first_name.errors %}
                    <p class="text-red-600 text-sm italic pb-2">{{ error }}</p>
                    {% endfor %} {% endif %}
                </div>
                <div class="w-full md:w-1/2 px-3">
                    <label class="block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2" for="{{ form.last_name.id_for_label }}">
                        {{ form.last_name.label }}
                    </label> {{ form.last_name }} {% if form.last_name.errors %} {% for error in form.last_name.errors %}
                    <p class="text-red-600 text-sm italic pb-2">{{ error }}</p>
                    {% endfor %} {% endif %}
                </div>
            </div>
            <div class="flex flex-wrap -mx-3 mb-6">
                <div class="w-full md:w-1/2 px-3 mb-6 md:mb-0">
                    <label class="block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2" for="{{ form.email.id_for_label }}">
                        {{ form.email.label }}
                    </label> {{ form.email }} {% if form.email.errors %} {% for error in form.email.errors %}
                    <p class="text-red-600 text-sm italic pb-2">{{ error }}</p>
                    {% endfor %} {% endif %}
                </div>
                <div class="w-full md:w-1/2 px-3 mb-6 md:mb-0">
                    <label class="block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2" for="{{ form.account_type.id_for_label }}">
                        {{ form.account_type.label }}
                    </label> {{ form.account_type }} {% if form.account_type.errors %} {% for error in form.account_type.errors %}
                    <p class="text-red-600 text-sm italic pb-2">{{ error }}</p>
                    {% endfor %} {% endif %}
                </div>
            </div>
            <div class="flex flex-wrap -mx-3 mb-6">
                <div class="w-full md:w-1/2 px-3 mb-6 md:mb-0">
                    <label class="block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2" for="{{ form.gender.id_for_label }}">
                        {{ form.gender.label }}
                    </label> {{ form.gender }} {% if form.gender.errors %} {% for error in form.gender.errors %}
                    <p class="text-red-600 text-sm italic pb-2">{{ error }}</p>
                    {% endfor %} {% endif %}
                </div>
                <div class="w-full md:w-1/2 px-3 mb-6 md:mb-0">
                    <label class="block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2" for="{{ form.birth_date.id_for_label }}">
                        {{ form.birth_date.label }}
                    </label> {{ form.birth_date }} {% if form.birth_date.errors %} {% for error in form.birth_date.errors %}
                    <p class="text-red-600 text-sm italic pb-2">{{ error }}</p>
                    {% endfor %} {% endif %}
                </div>
            </div>
            <div class="flex flex-wrap -mx-3">
                <div class="w-full md:w-1/2 px-3 mb-6 md:mb-0">
                    <label class="block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2" for="{{ form.password1.id_for_label }}">
                        {{ form.password1.label }}
                    </label> {{ form.password1 }} {% if form.password1.errors %} {% for error in form.password1.errors %}
                    <p class="text-red-600 text-sm italic pb-2">{{ error }}</p>
                    {% endfor %} {% endif %}
                </div>
                <div class="w-full md:w-1/2 px-3 mb-6 md:mb-0">
                    <label class="block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2" for="{{ form.password2.id_for_label }}">
                        {{ form.password2.label }}
                    </label> {{ form.password2 }} {% if form.password2.errors %} {% for error in form.password2.errors %}
                    <p class="text-red-600 text-sm italic pb-2">{{ error }}</p>
                    {% endfor %} {% endif %}
                </div>
            </div>

            {% for hidden_field in form.hidden_fields %} {{ hidden_field.errors }} {{ hidden_field }} {% endfor %}
            <div class="flex flex-wrap -mx-3 mb-6">
                <div class="w-full md:w-1/2 px-3 mb-6 md:mb-0">
                    <label class="block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2" for="{{ form.street_address.id_for_label }}">
                        {{ form.street_address.label }}
                    </label> {{ form.street_address }} {% if form.street_address.errors %} {% for error in form.street_address.errors %}
                    <p class="text-red-600 text-sm italic pb-2">{{ error }}</p>
                    {% endfor %} {% endif %}
                </div>
                <div class="w-full md:w-1/2 px-3">
                    <label class="block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2" for="{{ form.city.id_for_label }}">
                        {{ form.city.label }}
                    </label> {{ form.city }} {% if form.city.errors %} {% for error in form.city.errors %}
                    <p class="text-red-600 text-sm italic pb-2">{{ error }}</p>
                    {% endfor %} {% endif %}
                </div>
            </div>
            <div class="flex flex-wrap -mx-3 mb-6">
                <div class="w-full md:w-1/2 px-3 mb-6 md:mb-0">
                    <label class="block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2" for="{{ form.postal_code.id_for_label }}">
                        {{ form.postal_code.label }}
                    </label> {{ form.postal_code }} {% if form.postal_code.errors %} {% for error in form.postal_code.errors %}
                    <p class="text-red-600 text-sm italic pb-2">{{ error }}</p>
                    {% endfor %} {% endif %}
                </div>
                <div class="w-full md:w-1/2 px-3">
                    <label class="block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2" for="{{ form.country.id_for_label }}">
                        {{ form.country.label }}
                    </label> {{ form.country }} {% if form.country.errors %} {% for error in form.country.errors %}
                    <p class="text-red-600 text-sm italic pb-2">{{ error }}</p>
                    {% endfor %} {% endif %}
                </div>
            </div>
            <div class="flex items-center justify-between">
                <button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline" type="submit">
                    Update
                </button>
            </div>
        </form>
    </div>
</div> {% endcomment %}

{% comment %} <div class="max-w-3xl mx-auto bg-white shadow-md rounded-xl p-6">
    <div class="text-center">
        <img src="{% static 'path/to/profile-image.jpg' %}" alt="Profile Picture"
            class="w-24 h-24 rounded-full mx-auto border-4 border-blue-500" />
        <h2 class="font-bold text-2xl mt-4">{{ request.user.get_full_name }}</h2>
        <p class="text-gray-600">{{ request.user.email }}</p>
    </div>
    <hr class="my-6">
    <h3 class="text-xl font-semibold text-gray-700 text-center">Account Information</h3>
    <div class="bg-gray-100 p-4 rounded-lg shadow-sm mt-4">
        <p class="text-gray-700"><strong>Account No:</strong> {{ request.user.account.account_no }}</p>
        <p class="text-gray-700"><strong>Account Type:</strong> {{ request.user.account.account_type }}</p>
        <p class="text-gray-700"><strong>Balance:</strong> {{ request.user.account.balance }}</p>
    </div>
    <hr class="my-6">
    <h1 class="font-bold text-3xl text-center">Update Profile Information</h1>
    <form method="post" class="mt-6">
        {% csrf_token %}
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
                <label class="block text-sm font-medium text-gray-700">{{ form.first_name.label }}</label>
                {{ form.first_name }}
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700">{{ form.last_name.label }}</label>
                {{ form.last_name }}
            </div>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-4">
            <div>
                <label class="block text-sm font-medium text-gray-700">{{ form.email.label }}</label>
                {{ form.email }}
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700">{{ form.account_type.label }}</label>
                {{ form.account_type }}
            </div>
        </div>
        <div class="flex justify-center mt-6">
            <button type="submit" class="bg-blue-600 text-white px-6 py-2 rounded-lg font-bold hover:bg-blue-700">
                Update Profile
            </button>
        </div>
    </form>
</div> {% endcomment %}

{% comment %} <div class="max-w-3xl mx-auto bg-white shadow-md rounded-xl p-6">
    <!-- Profile Card Section -->
    <div class="text-center">
        <img id="imagePreview" src="{% if user.profile_picture %}{{ user.profile_picture.url }}{% else %}{% static 'default-profile.png' %}{% endif %}" 
            class="w-24 h-24 rounded-full mx-auto border-4 border-blue-500" />
        <h2 class="font-bold text-2xl mt-4">{{ request.user.get_full_name }}</h2>
        <p class="text-gray-600">{{ request.user.email }}</p>
        <p class="text-gray-600"><strong>Account No:</strong> {{ request.user.account.account_no }}</p>
        <p class="text-gray-600"><strong>Account Type:</strong> {{ request.user.account.account_type }}</p>
        <p class="text-gray-600"><strong>Balance:</strong> {{ request.user.account.balance }}</p>
    </div>

    <!-- Edit Button -->
    <div class="flex justify-center mt-4">
        <a href="{% url 'register' %}" 
            class="bg-blue-600 text-white px-6 py-2 rounded-lg font-bold hover:bg-blue-700">
            Edit Profile
        </a>
    </div>

    <hr class="my-6">

    <!-- Profile Update Form -->
    <h1 class="font-bold text-3xl text-center">Update Profile Information</h1>
    <form method="post" enctype="multipart/form-data" class="mt-6">
        {% csrf_token %}
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
                <label class="block text-sm font-medium text-gray-700">{{ form.first_name.label }}</label>
                {{ form.first_name }}
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700">{{ form.last_name.label }}</label>
                {{ form.last_name }}
            </div>
        </div>

        <!-- Profile Picture Upload with Live Preview -->
        <div class="mt-6 text-center">
            <label class="block text-sm font-medium text-gray-700">Upload Profile Picture</label>
            <input type="file" name="profile_picture" id="profilePicture" class="border border-gray-300 rounded-md px-3 py-2 w-full" accept="image/*" onchange="previewImage()">
        </div>

        <div class="flex justify-center mt-6">
            <button type="submit" class="bg-blue-600 text-white px-6 py-2 rounded-lg font-bold hover:bg-blue-700">
                Update Profile
            </button>
        </div>
    </form>
</div> {% endcomment %}



<div class="max-w-3xl mx-auto">
    <!-- Profile Card Section -->
  <div class="bg-white shadow-md rounded-xl p-6 mb-6">
    <div class="text-center">
      <!--<img id="imagePreview" src="{% if user.profile_picture %}{{ user.profile_picture.url }}{% else %}{% static 'default-profile.png' %}{% endif %}" 
           alt="Profile Picture"
           class="w-24 h-24 rounded-full mx-auto border-4 border-blue-500" />-->
      <h2 class="font-bold text-2xl mt-4">{{ request.user.get_full_name }}</h2>
      <p class="text-gray-600">{{ request.user.email }}</p>
      <p class="text-gray-600"><strong>Account No:</strong> {{ request.user.account.account_no }}</p>
      <p class="text-gray-600"><strong>Account Type:</strong> {{ request.user.account.account_type }}</p>
      <p class="text-gray-600"><strong>Balance:</strong> {{ request.user.account.balance }}</p>
    </div>
    <div class="flex justify-center mt-4">
      <!-- When clicked, this button toggles the update form -->
      <button onclick="toggleUpdateForm()" 
              class="bg-blue-600 text-white px-6 py-2 rounded-lg font-bold hover:bg-blue-700">
        Edit Profile
      </button>
    </div>
  </div>
    
    <!-- Update Profile Form (Hidden by Default) -->
    <div id="updateForm" class="bg-white px-3 py-4 rounded-xl my-6" style="display: none;">
        <h1 class="font-bold text-3xl text-center pb-5">Update Profile Information</h1>
        <form method="post" enctype="multipart/form-data" class="bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4">
            {% csrf_token %}
            
            <!-- Username & Email -->
            <div class="flex flex-wrap -mx-3 mb-6">
                <div class="w-full px-3">
                    <label class="block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2">
                        Email
                    </label>
                    {{ form.email }}
                </div>
            </div>

            <!-- Street Address, City, Postal Code, Country -->
            <div class="flex flex-wrap -mx-3 mb-6">
                <div class="w-full md:w-1/2 px-3 mb-6 md:mb-0">
                    <label class="block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2">
                        Street Address
                    </label>
                    {{ form.street_address }}
                </div>
                <div class="w-full md:w-1/2 px-3">
                    <label class="block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2">
                        City
                    </label>
                    {{ form.city }}
                </div>
            </div>
            <div class="flex flex-wrap -mx-3 mb-6">
                <div class="w-full md:w-1/2 px-3 mb-6 md:mb-0">
                    <label class="block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2">
                        Postal Code
                    </label>
                    {{ form.postal_code }}
                </div>
                <div class="w-full md:w-1/2 px-3">
                    <label class="block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2">
                        Country
                    </label>
                    {{ form.country }}
                </div>
            </div>

            <!-- Profile Picture Upload -->
         <!--   <div class="mt-6 text-center">
                <label class="block text-sm font-medium text-gray-700">Upload Profile Picture</label>
                <input type="file" name="profile_picture" id="profilePictureInput"
                    class="border border-gray-300 rounded-md px-3 py-2 w-full" accept="image/*" onchange="previewImage()">
            </div> -->

            <!-- Submit Button -->
            <div class="flex justify-center mt-6">
                <button type="submit"
                    class="bg-blue-600 text-white px-6 py-2 rounded-lg font-bold hover:bg-blue-700">
                    Update Profile
                </button>
            </div>
        </form>
    </div>
</div>

<!-- JavaScript for toggling update form and previewing image -->
<script>
function toggleUpdateForm() {
    var formDiv = document.getElementById("updateForm");
    formDiv.style.display = formDiv.style.display === "none" ? "block" : "none";
}

{% comment %} function previewImage() {
    var file = document.getElementById('profilePictureInput').files[0];
    var preview = document.getElementById('imagePreview');
    if (file) {
        var reader = new FileReader();
        reader.onload = function(e) {
            preview.src = e.target.result;
        };
        reader.readAsDataURL(file);
    }
} {% endcomment %}
</script>




{% endblock %} 

